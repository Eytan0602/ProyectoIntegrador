<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title th:text="${titulo}">Policía Nacional del Perú</title>
  <meta name="description" content="Inspirado en pnp.gob.pe. No es un sitio oficial." />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    /* Añadir estos estilos al CSS existente */
    .user-menu {
      position: relative;
      display: inline-block;
    }

    .user-menu-button {
      background: var(--accent-green);
      color: white;
      border: none;
      padding: 0.75rem 1.25rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
    }

    .user-menu-button:hover {
      background: #218838;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }

    .user-menu-dropdown {
      position: absolute;
      top: calc(100% + 0.5rem);
      right: 0;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      box-shadow: var(--shadow-hover);
      min-width: 250px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .user-menu-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .user-info {
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
    }

    .user-info .user-name {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
    }

    .user-info .user-dni {
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .user-menu-dropdown a,
    .user-menu-dropdown button {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.875rem 1rem;
      color: var(--text-primary);
      text-decoration: none;
      border: none;
      background: none;
      width: 100%;
      text-align: left;
      cursor: pointer;
      transition: background 0.2s ease;
      font-size: 0.95rem;
    }

    .user-menu-dropdown a:hover,
    .user-menu-dropdown button:hover {
      background: var(--bg-secondary);
    }

    .user-menu-dropdown a i,
    .user-menu-dropdown button i {
      width: 20px;
      color: var(--text-secondary);
    }

    .user-menu-dropdown .logout-btn {
      border-top: 1px solid var(--border-color);
      color: var(--error-color);
    }

    .user-menu-dropdown .logout-btn:hover {
      background: rgba(220, 53, 69, 0.1);
    }

    .user-menu-dropdown .logout-btn i {
      color: var(--error-color);
    }

    .login-button {
      background: var(--accent-green);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
    }

    .login-button:hover {
      background: #218838;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }

    .theme-toggle-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.875rem 1rem;
      border-bottom: 1px solid var(--border-color);
    }

    .theme-toggle-item span {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: var(--text-primary);
      font-size: 0.95rem;
    }

    .theme-toggle-item i {
      width: 20px;
      color: var(--text-secondary);
    }

    .theme-switch {
      position: relative;
      width: 48px;
      height: 24px;
    }

    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .theme-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--border-color);
      transition: .3s;
      border-radius: 24px;
    }

    .theme-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }

    .theme-switch input:checked + .theme-slider {
      background-color: var(--accent-green);
    }

    .theme-switch input:checked + .theme-slider:before {
      transform: translateX(24px);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .user-menu-dropdown {
        right: auto;
        left: 50%;
        transform: translateX(-50%) translateY(-10px);
        min-width: 280px;
      }

      .user-menu-dropdown.show {
        transform: translateX(-50%) translateY(0);
      }
    }
  </style>
  
  <link rel="stylesheet" href="/JS/css/index.css">
</head>
<body>
  <header>
    <div class="container branding">
      <div class="logo">
        <img src="/JS/imagenes/images.png" alt="Escudo Nacional del Perú">
      </div>
      <div>
        <h1 class="site-title">Policía Nacional del Perú</h1>
      </div>
    </div>
    <nav aria-label="principal">
      <div class="container nav-wrap">
        <!-- Hamburger Menu Button -->
        <button class="menu-toggle" id="btnMenu" aria-label="Abrir menú" aria-expanded="false">
          <span></span>
          <span></span>
          <span></span>
        </button>

        <div id="main-menu" class="menu" role="menubar">
          <a role="menuitem" href="#institucional">Institucional</a>
          <a role="menuitem" href="#servicios">Servicios</a>
          <a role="menuitem" href="#tramites">Trámites</a>
          <a role="menuitem" href="#noticias">Noticias</a>
          <a role="menuitem" href="https://denuncias.servicios.gob.pe/?gobpe_id=283" target="_blank">Denuncia en línea</a>
        </div>

        <div style="display: flex; align-items: center; gap: 1rem;">
          <form class="search" role="search" onsubmit="event.preventDefault(); doSearch();">
            <label class="sr-only" for="q">Buscar</label>
            <input id="q" name="q" type="search" placeholder="Buscar en el portal…" aria-label="Buscar en el portal" />
            <button class="btn" type="submit">Buscar</button>
          </form>

          <!-- User Menu (when authenticated) -->
          <div class="user-menu" sec:authorize="isAuthenticated()">
            <button class="user-menu-button" id="userMenuBtn" aria-label="Menú de usuario">
              <i class="fas fa-user-circle"></i>
              <span sec:authentication="name"></span>
              <i class="fas fa-chevron-down"></i>
            </button>
            
            <div class="user-menu-dropdown" id="userMenuDropdown">
              <div class="user-info">
                <div class="user-name">Usuario</div>
                <div class="user-dni">DNI: <span sec:authentication="name"></span></div>
              </div>
              
              <div class="theme-toggle-item">
                <span>
                  <i class="fas fa-moon"></i>
                  Tema Oscuro
                </span>
                <label class="theme-switch">
                  <input type="checkbox" id="themeToggleSwitch" onchange="toggleTheme()">
                  <span class="theme-slider"></span>
                </label>
              </div>
              
             
              
              <a href="/seguimiento-tramite">
                <i class="fas fa-search"></i>
                Seguimiento
              </a>
              
              <form th:action="@{/logout}" method="post" style="margin: 0;">
                <button type="submit" class="logout-btn">
                  <i class="fas fa-sign-out-alt"></i>
                  Cerrar Sesión
                </button>
              </form>
            </div>
          </div>

          <!-- Login Button (when not authenticated) -->
          <a href="/login" class="login-button" sec:authorize="!isAuthenticated()">
            <i class="fas fa-sign-in-alt"></i>
            Iniciar Sesión
          </a>
        </div>
      </div>
    </nav>
  </header>

  <section class="hero" id="institucional">
    <div class="cover" aria-hidden="true"></div>
    <div class="overlay" aria-hidden="true"></div>
    <div class="container content">
      <div>
        <h1>Servir y proteger: información, trámites y servicios en un solo lugar</h1>
        <p>Este proyecto está inspirado en el portal institucional de la Policía Nacional del Perú...</p>
        <div class="cta-row">
          <a class="btn" href="#servicios">Servicios más consultados</a>
          <a class="btn alt" href="https://denuncias.servicios.gob.pe/?gobpe_id=283" target="_blank">Denunciar en línea</a>
        </div>
      </div>
    </div>
  </section>

  <section class="section" id="servicios">
    <div class="container">
      <h2>Servicios más consultados</h2>
      <div class="grid">
        <article class="card">
          <span class="chip">Online</span>
          <h3>Denuncia policial digital</h3>
          <p>Registra denuncias no flagrantes y obtén el cargo digital.</p>
          <a class="link" href="https://denuncias.servicios.gob.pe/?gobpe_id=283" target="_blank">Ir al servicio →</a>
        </article>
        <article class="card">
          <span class="chip">Pago</span>
          <h3>Certificado de antecedentes policiales</h3>
          <p>Solicita y descarga tu certificado para trámites.</p>
          <a class="link" href="https://www.gob.pe/324-certificado-de-antecedentes-policiales-para-viaje-o-uso-en-el-extranjero" target="_blank">Solicitar →</a>
        </article>
        <article class="card">
          <span class="chip">Trámites</span>
          <h3>Permiso lunas polarizadas</h3>
          <p>Consulta el estado de tu permiso para lunas polarizadas y realiza los pagos.</p>
          <a class="link" href="dni">Consultar →</a>
        </article>
        <article class="card">
          <span class="chip">Orientación</span>
          <h3>Comisarías y teléfonos</h3>
          <p>Busca la comisaría más cercana a tu ubicación.</p>
          <a class="link" href="https://www.gob.pe/912-ubicar-la-comisaria-mas-cercanas" target="_blank">Ver mapa →</a>
        </article>
      </div>
    </div>
  </section>

  <section class="section alt" id="noticias">
    <div class="container">
      <h2>Noticias y comunicados</h2>
      <div class="grid">
        <article class="news-card">
          <img alt="Foto noticia 1" src="/JS/imagenes/noticia1.jpeg" />
          <div class="body">
            <div class="news-meta">08 Ago 2025 • Institucional</div>
            <h3>Comprometidos con la Seguridad del País, la Policía Nacional del Perú inaugura la III RECOPOL 2025</h3>
            <p>El alto mando institucional evalúa avances estratégicos y proyecta acciones clave para fortalecer la seguridad ciudadana y combatir la criminalidad</p>
            <a class="link" href="https://www.gob.pe/institucion/pnp/noticias/1182903-comprometidos-con-la-seguridad-del-pais-la-policia-nacional-del-peru-inaugura-la-iii-recopol-2025" target="_blank">Leer más →</a>
          </div>
        </article>
        <article class="news-card">
          <img alt="Foto noticia 2" src="/JS/imagenes/noticia2.jpg">
          <div class="body">
            <div class="news-meta">06 Ago 2025 • Seguridad</div>
            <h3>Dircote PNP captura a terrorista alias "Tarazona"</h3>
            <p>Cuenta con doce órdenes de captura vigentes.</p>
            <a class="link" href="https://www.gob.pe/institucion/pnp/noticias/1143319-dircote-pnp-captura-a-terrorista-alias-tarazona" target="_blank">Leer más →</a>
          </div>
        </article>
        <article class="news-card">
          <img alt="Foto noticia 3" src="/JS/imagenes/1094381-0.jpeg" />
          <div class="body">
            <div class="news-meta">02 Ago 2025 • Tránsito</div>
            <h3>Policía ejecuta operativo en Establecimiento Penitenciario Ancón I</h3>
            <p>En cumplimiento al plan de operaciones "Orden y Seguridad".</p>
            <a class="link" href="https://www.gob.pe/institucion/pnp/noticias/1094381-policia-ejecuta-operativo-en-establecimiento-penitenciario-ancon-i" target="_blank">Leer más →</a>
          </div>
        </article>
      </div>
    </div>
  </section>

  <section class="section" id="tramites">
    <div class="container">
      <h2>Trámites y enlaces de interés</h2>
      <div class="grid">
        <article class="card">
          <span class="chip"><i class="fas fa-search"></i> Consulta</span>
          <h3>Seguimiento de Trámites</h3>
          <p>Consulta el estado de tu trámite de lunas polarizadas ingresando tu DNI.</p>
          <a class="link" href="/seguimiento-tramite">Consultar →</a>
        </article>
        <article class="card">
          <h3>Transparencia</h3>
          <p>Presupuesto, contrataciones, normatividad y más.</p>
          <a class="link" href="https://www.transparencia.gob.pe/reportes_directos/pep_transparencia_acceso_informacion.aspx?id_entidad=13185&id_tema=49&cod_rueep=0&ver=D" target="_blank">Ir →</a>
        </article>
        <article class="card">
          <h3>Mesa de partes</h3>
          <p>Presenta documentos de manera virtual.</p>
          <a class="link" href="https://mpd.policia.gob.pe/mesadepartesdigital/" target="_blank">Presentar →</a>
        </article>
        <article class="card">
          <h3>Libro de reclamaciones</h3>
          <p>Registra un reclamo o queja sobre la atención.</p>
          <a class="link" href="https://reclamos.servicios.gob.pe/?institution_id=160" target="_blank">Registrar →</a>
        </article>
      </div>
    </div>
  </section>

  <footer>
    <div class="container foot-grid">
      <div class="foot-col">
        <h4>Contacto</h4>
        <p>Central telefónica: 01 1234567<br>Emergencias: <strong>105</strong><br>Atención: 24/7</p>
      </div>
      <div class="foot-col">
        <h4>Redes</h4>
        <a href="https://www.facebook.com/Policia" target="_blank">Facebook</a>
        <a href="https://x.com/policiaperu" target="_blank">X (Twitter)</a>
        <a href="https://www.youtube.com/c/Polic%C3%ADaPer%C3%BA" target="_blank">YouTube</a>
      </div>
    </div>
    <div class="container foot-bottom">
      <div>No es un sitio oficial de la PNP.</div>
      <div>© 2025 – Curso Integrador I</div>
    </div>
  </footer>

<script src="/JS/js/index.js"></script>
<script>
  // Theme Toggle
  function toggleTheme() {
    const html = document.documentElement;
    const currentTheme = html.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    html.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    
    const themeSwitch = document.getElementById('themeToggleSwitch');
    if (themeSwitch) {
      themeSwitch.checked = newTheme === 'dark';
    }
  }

  // Load saved theme
  window.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    
    const themeSwitch = document.getElementById('themeToggleSwitch');
    if (themeSwitch) {
      themeSwitch.checked = savedTheme === 'dark';
    }
  });

  // User Menu Toggle
  const userMenuBtn = document.getElementById('userMenuBtn');
  const userMenuDropdown = document.getElementById('userMenuDropdown');

  if (userMenuBtn && userMenuDropdown) {
    userMenuBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      userMenuDropdown.classList.toggle('show');
    });

    document.addEventListener('click', (e) => {
      if (!userMenuDropdown.contains(e.target) && !userMenuBtn.contains(e.target)) {
        userMenuDropdown.classList.remove('show');
      }
    });
  }

  // Search function
  function doSearch() {
    const q = document.getElementById('q');
    if (!q || !q.value.trim()) {
      alert('Ingresa un término de búsqueda.');
      return;
    }

    const searchTerm = q.value.trim().toLowerCase();
    const cards = document.querySelectorAll('.card');
    let found = false;

    cards.forEach(card => {
      const text = card.innerText.toLowerCase();
      if (text.includes(searchTerm)) {
        card.style.display = 'block';
        found = true;
      } else {
        card.style.display = 'none';
      }
    });

    if (!found) {
      alert('No se encontraron resultados para: ' + searchTerm);
      cards.forEach(card => card.style.display = 'block');
    }
  }
</script>
</body>
</html>